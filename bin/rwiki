#!/usr/bin/env ruby
# encoding: utf-8

$LOAD_PATH.unshift(File.join(File.dirname(__FILE__), '..', 'lib'))
require 'thin'
require 'rwiki'

config = Rwiki::Configuration.instance
p "Working path is: #{config[:working_path]}"
Rwiki::Models::Node.working_path = config[:working_path]

argv = ARGV
rackup_file = "#{File.dirname(__FILE__)}/../lib/rwiki/config.ru"
argv << ["-R", rackup_file] unless ARGV.include?("-R")
argv << ["-p", "2003"] unless ARGV.include?("-p")
argv << ["-e", "production"] unless ARGV.include?("-e")

Thin::Runner.new(argv.flatten).run!
